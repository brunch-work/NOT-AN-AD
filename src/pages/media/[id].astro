---
import Layout from "../../layouts/Layout.astro";
import Lightbox from "../../components/Lightbox.astro";
import { mediaQuery } from "../../gql/queries";

export const prerender = false;

const { id } = Astro.params;

const response = await fetch("https://graphql.datocms.com/", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    Accept: "application/json",
    Authorization: `Bearer ${import.meta.env.DATOCMS_API_KEY}`,
  },
  body: JSON.stringify({
    query: mediaQuery,
    variables: { id },
  }),
});

const json = await response.json();
const { upload } = json.data;
---

<Layout>
  <div class="media-page subgrid">
    <div class="media">
      <Lightbox asset={upload} />
    </div>
  </div>
</Layout>
